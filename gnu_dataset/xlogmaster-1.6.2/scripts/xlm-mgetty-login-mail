#!/bin/sh
#
# xlm-mgetty-login-mail
# by Georg C. F. Greve <greve@gnu.org>
#
# This is a script for the Xlogmaster
#
# usage:
# xlm-mgetty-login-mail <notification address> <originator address>
#

line="$XLM_LINE"
notify="$1"
my_identity="$2"

LOGIN_PID=`echo $line | cut -f 2 -d , | cut -f 2 -d "'" `
LOGIN_FROM=`echo $line | cut -f 3 -d , | cut -f 2 -d "'" `
LOGIN_SPEED=`echo $line | cut -f 4 -d , | cut -f 2 -d "'" `
LOGIN_WITH=`echo $line | cut -f 6 -d , | cut -f 2 -d "'" `
LOGIN_BY=`echo $line | cut -f 7 -d , | cut -f 2 -d "'" `
LOGIN_DAY=`echo $line | cut -f 1 -d " " `
LOGIN_TIME=`echo $line | cut -f 2 -d " " `
LOGIN_PORT=`echo $line | cut -f 5 -d " " `

echo -e "From: $my_identity\n\
Subject: login by $LOGIN_BY at $LOGIN_TIME on $LOGIN_DAY via mgetty\n\n\
Login by $LOGIN_BY on $LOGIN_PORT\n\n\
$LOGIN_WITH has been started - statistics:\n\n\
origin: $LOGIN_FROM\n\
speed:  $LOGIN_SPEED\n\
date:   $LOGIN_DAY\n\
time:   $LOGIN_TIME\n\
port:   $LOGIN_PORT\n\
pid:    $LOGIN_PID\n\n\
regards, your Xlogmaster.\n\n" | sendmail $notify

