<html lang="en">
<head>
<title>Focuses Getstart - 3DLDF User and Reference Manual</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="3DLDF User and Reference Manual">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Pictures.html#Pictures" title="Pictures">
<link rel="prev" href="Projections.html#Projections" title="Projections">
<link rel="next" href="Surface-Hiding.html#Surface-Hiding" title="Surface Hiding">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This is the 3DLDF User and Reference Manual, edition 1.1.5.1 for
3DLDF 1.1.5.1.
This manual was last updated on
16 January 2004.

3DLDF is a GNU package for three-dimensional drawing with MetaPost
output.
The author is Laurence D. Finston.

Copyright (C) 2003, 2004 , 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013 The Free Software Foundation

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.2 or any later version published by the Free Software
     Foundation; with no Invariant Sections, no Front-Cover Texts, and
     no Back-Cover Texts.  A copy of the license is included in the
     section entitled ``GNU Free Documentation License''.
   -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Focuses-Getstart"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Surface-Hiding.html#Surface-Hiding">Surface Hiding</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Projections.html#Projections">Projections</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Pictures.html#Pictures">Pictures</a>
<hr>
</div>

<h3 class="section">9.2 Focuses</h3>

<p><a name="index-focus-75"></a>The perspective transformation requires a focus;  as a consequence,
outputting a <code>Picture</code> requires an object of class
<code>Focus</code>. 
<code>Picture::output()</code> takes an optional pointer-to-<code>Focus</code>
argument, which is 0 by default.  If the default is used, (or 0 is
passed explicitly), the global variable <code>default_focus</code> is used. 
See <a href="Focus-Global-Variables.html#Focus-Global-Variables">Focus Reference; Global Variables</a>.

   <p>A <code>Focus</code> can be thought of as the observer of a scene, or a
camera.  It contains a <code>Point position</code> for its location with
respect to 3DLDF's coordinate system, and a <code>Point direction</code>,
specifying the direction where the observer is looking, or where the
camera is pointed.  The <code>Focus</code> can be rotated freely about the
line
PD,
where P stands for <code>position</code> and
D
for <code>direction</code>,
so a <code>Focus</code> contains a third <code>Point up</code>, to indicate which
direction will be &ldquo;up&rdquo; on the projection, when a <code>Picture</code> is
projected.

   <p>The projection plane q
will always be perpendicular to
the line PD,
or to put it another way,
the line PD,
is normal to q.

   <p>Unlike the traditional perspective construction, where the distance from
the focus to the center of vision fixes both the location of the focus
in space, and its distance to the
picture plane,<a rel="footnote" href="#fn-1" name="fnd-1"><sup>1</sup></a>
these two parameters can be set independently when the perspective
transformation is used. 
The distance from a <code>Focus</code> to the picture plane is stored in the
data member <code>distance</code>, of type <code>real</code>.

   <p>A <code>Focus</code> can be declared using two <code>Point</code> arguments for
<code>position</code> and <code>direction</code>, and a <code>real</code> argument for
<code>distance</code>, in that order.

<pre class="example">     Point pos(0, 5, -10);
     Point dir(0, 5, 10);
     Focus f(pos, dir, 10);
     
     Point center(2, 0, 3);
     Rectangle r(center, 3, 3);
     r.draw();
     current_picture.output(f);
</pre>
   <p><p align="center">
<br>
<img src="./graphics/png/3DLDF60.png"
alt="[Figure 60. Not displayed.]" 
/>
<br>
<br>
Fig. 60. 
<br>
</p>

   <p>The &ldquo;up&rdquo; direction is calculated by the <code>Focus</code> constructor
automatically.  An optional argument can be used to specify the angle by
which to rotate the <code>Focus</code> about
the line PD.

<pre class="example">     Point pos(0, 5, -10);
     Point dir(0, 5, 10);
     Focus f(pos, dir, 10, 30);
     Point center(2, 0, 3);
     Rectangle r(center, 3, 3);
     r.draw();
     current_picture.output(f);
</pre>
   <p><p align="center">
<br>
<img src="./graphics/png/3DLDF61.png"
alt="[Figure 61. Not displayed.]" 
/>
<br>
<br>
Fig. 61. 
<br>
</p>

   <p>Alternatively, a <code>Focus</code> can be declared using three <code>real</code>
arguments each for the x, y, and z-coordinates of <code>position</code> and
<code>direction</code>, respectively, followed by the <code>real</code> arguments
for <code>distance</code> and the angle of rotation:

<pre class="example">     Focus f(3, 5, -5, 0, 3, 0, 10, 10);
     Point center(2, 0, 3);
     Rectangle r(center, 3, 3);
     r.draw();
     current_picture.output(f);
</pre>
   <p><p align="center">
<br>
<img src="./graphics/png/3DLDF62.png"
alt="[Figure 62. Not displayed.]" 
/>
<br>
<br>
Fig. 62. 
<br>
</p>

   <p><code>Focuses</code> contain two <code>Transforms</code>, <code>transform</code> and <code>persp</code>. 
A <code>Focus</code> can be located anywhere in 3DLDF's coordinate system. 
However, performing the perspective projection is more convenient, if
<code>position</code> and <code>direction</code> both lie on one of the major axes,
and the plane of projection corresponds to one of the major planes. 
<code>transform</code> is the transformation which would have this affect on
the <code>Focus</code>, and is calculated by the <code>Focus</code> constructor. 
When a <code>Picture</code> is output using that <code>Focus</code>,
<code>transform</code> is applied to all of the <code>Shapes</code> on the
<code>Picture</code>, maintaining the relationship between the <code>Focus</code>
and the <code>Shapes</code>, while making it easier to calculate the
projection.  The <code>Focus</code> need never be
transformed by <code>transform</code>. 
The actual perspective transformation is stored
in <code>persp</code>.

   <p><code>Focuses</code> can be moved by using one of the setting functions, which
take the same arguments as the constructors. 
<!-- !! TO DO: -->
Currently, there are no affine transformation functions for moving
<code>Focuses</code>, but I plan to add them soon.  If 3DLDF is used for
making
<a name="index-animation-76"></a>animation, resetting the <code>Focus</code> can be used to simulate camera
movements:

<pre class="example">     beginfig(1);
     Point pos(2, 10, 3);
     Point dir(2, -10, 3);
     Focus f;
     Point center(2, 0, 3);
     for (int i = 0; i &lt; 5; ++i)
       {
         f.set(pos, dir, 10, (15 * i));
         Rectangle r(center, 3, 3);
         r.draw();
         current_picture.output(f);
         current_picture.clear();
         pos.shift(1, 1, 0);
         dir.rotate(0, 0, 10);
       }
     endfig(1);
</pre>
   <p><p align="center">
<br>
<img src="./graphics/png/3DLDF63.png"
alt="[Figure 63. Not displayed.]" 
/>
<br>
<br>
Fig. 63. 
<br>
</p>

   <p>In [the previous figure]
, <code>current_picture</code> is output 5 times within a single
MetaPost figure.  Since the file passed to MetaPost is called
<samp><span class="file">persp.mp</span></samp>, the file of Encapsulated PostScript (EPS) code
containing [the previous figure]
 is called <samp><span class="file">persp.1</span></samp>. 
<a name="index-animation-77"></a>To use this technique for making an animation, it's necessary to output
the <code>Picture</code> into multiple MetaPost figures.

<pre class="example">     Point pos(2, 10, 3);
     Point dir(2, -10, 3);
     Focus f;
     Point center(2, 0, 3);
     for (int i = 0; i &lt; 5; ++i)
       {
         f.set(pos, dir, 10, (15 * i));
         Rectangle r(center, 3, 3);
         r.draw();
         beginfig(i+1);
         current_picture.output(f);
         endfig();
         current_picture.clear();
         pos.shift(1, 1, 0);
         dir.rotate(0, 0, 10);
       }
</pre>
   <p>Now, running MetaPost on <samp><span class="file">persp.mp</span></samp> generates the EPS files
<samp><span class="file">persp.1</span></samp>, <samp><span class="file">persp.2</span></samp>, <samp><span class="file">persp.3</span></samp>, <samp><span class="file">persp.4</span></samp>, and
<samp><span class="file">persp.5</span></samp>, containing the five separate drawings of <var>r</var>. 
<!-- !! TO DO:  Add a node ``Animation''.  When I've done so, put a cross -->
<!-- reference here.  LDF 2003.08.15. -->

   <div class="footnote">
<hr>
<h4>Footnotes</h4><p class="footnote"><small>[<a name="fn-1" href="#fnd-1">1</a>]</small> I believe this
to be true, but I'm not
certain.</p>

   <hr></div>

   </body></html>

