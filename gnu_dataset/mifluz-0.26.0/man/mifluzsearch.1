'''
''' Part of the ht://Dig package   <http://www.htdig.org/>
''' Copyright (c) 1999, 2000, 2001 The ht://Dig Group
''' For copyright details, see the file COPYING in your distribution
''' or the GNU General Public License version 2 or later
''' <http://www.gnu.org/copyleft/gpl.html>
''' 
''' 
.TH mifluzsearch 1 local
.SH NAME
mifluzsearch \-
search the content of an inverted index.


.SH SYNOPSIS
.nf
.ft CW

mifluzsearch -f words [options]
.ft R
.fi

.SH DESCRIPTION

mifluzsearch searches a mifluz index for documents matching a 
Alt*Vista expression (simple syntax). The result of the search is
output on the standard output.

.SH SEARCH SYNTAX

The search syntax uses a + to indicate a mandatory word, a - to indicated
a forbiden word and double quotes (") to specify a literal.

.SH OPTIONS

.TP
.B -v
Increase verbosity.

.TP
.B -M config_file
use 
.B config_file 
instead of the default configuration file.

.TP
.B -B dbfile (default test)
use
.B dbfile
inverted index.

.TP
.B -f expr
search for documents that match 
.B expr.

.TP
.B -H
print a HTML header before the results so that mifluzsearch can be used
as a cgi-bin.

.TP
.B -o word
return the number of occurencs of 
.B word
in the inverted index.

.TP
.B -c number (default 10)
retrieve at most 
.B number
documents.

.TP
.B -d number (default 0)
the index of the first retrieved document starts at
.B number.
The number of documents retrieved after this document depends on the
.B -c 
option. If 
.B number is higher than the maximum document that matches the query,
it will be rounded to match the last chunk of document.

.TP
.B -n
only parse the search expression and print it.

.TP
.B -P proximity (default 1)
words are considered near to each other if they are at a maximum distance
of
.B proximity 
words. If the number is negative the word ordering does not matter.

.TP
.B -S
return at most one match per server.

.TP
.B -l key
searching will start at this position in the index. The 
.B key
is the ascii representation of a key.

.TP
.B -l key
searching will end at this position in the index. The 
.B key
is the ascii representation of a key.

.SH CONFIGURATION FILE

.TP
.B wordlist_wordkey_document

.TP
.B wordlist_wordkey_location

.TP
.B wordlist_wordkey_uniq


.SH RESULTS

Here is a sample text result:

.nf
.ft CW
match: <UNDEF>	<UNDEF>	0	5	<UNDEF>	(world the proximity)
match: <UNDEF>	<UNDEF>	0	21	<UNDEF>	(world the proximity)
match: <UNDEF>	<UNDEF>	0	51	<UNDEF>	(world the proximity)
match: <UNDEF>	<UNDEF>	0	81	<UNDEF>	(world the proximity)
count: 100
time: 20
base: 0
words: the an world
.ft R
.fi

Here is a sample xml result (provided the -x option was given):

.nf
.ft CW
<?xml version="1.0" encoding="ISO-8859-1" ?>
<searchresults>
<match><document>0 5 </document><info>world the proximity</info></match>
<match><document>0 21 </document><info>world the proximity</info></match>
<match><document>0 51 </document><info>world the proximity</info></match>
<match><document>0 81 </document><info>world the proximity</info></match>
<count>100</count>
<time>30</time>
<words>
	<verbatim>the an world </verbatim>
	<unaccent>the an world </unaccent>
</words>
<base>0</base>
</searchresults>
.ft R
.fi

.TP
.B match
is the document number that matches, as defined by 
.B wordlist_wordkey_document.

.TP
.B info
is a human readable information explaining why the document matched.

.TP
.B count
is an estimation of the total number of documents that match the query.

.TP
.B time
is the number of milliseconds that were necessary to process the query.

.TP
.B words verbatim
is the list of accented words of the query.

.TP
.B words unaccent
is the list of unaccented words of the query.

.TP
.B base
is the absolute index of the first document returned in the total
number of possible documents. For instance, if mifluzsearch was 
called with -d 50 -c 10 to require ten documents after the 50th
document, the base will be 50. However, if there are only 35
documents that match the query, the base will be rounded to the
30 and only 5 documents will be returned.

.SH CGI

Each option may be given in the 
.B QUERY_STRING 
environment variable so that mifluzsearch can be used as a cgi-bin
instead of a line command. The options are processed in the order
in which they appear in QUERY_STRING.

.nf
.ft CW
QUERY_STRING='v=1&f=a+word&M=/etc/mifluz.conf' mifluzsearch
.ft R
.fi

is strictly equivalent to 

.nf
.ft CW
mifluzsearch -v -f 'a word' -M /etc/mifluz.conf
.ft R
.fi

.SH DEBUG

Debugging information interpretation. A cursor is open in the index
for every word and they are stored in a list. The list of cursors
is always processed in the same order, as a single link list. With
-v, each block is an individual action on behalf of the word shown
on the first line. The last line of the block is the conclusion of
the action described in the block. REDO means the same cursor must
be examined again because the conditions have changed. RESTART means
we go back to the first cursor in the list because it may not 
match the new conditions anymore. NEXT means the cursor and all
the cursors before it match the conditions and we may proceed to
the next cursor. ATEND means the cursor cannot match the conditions
because it is at the end of the index.

.SH ENVIRONMENT

.B QUERY_STRING
options are extracted from QUERY_STRING in a CGI like fashion.

.B MIFLUZ_CONFIG
file name of configuration file read by WordContext(3). Defaults to
.B ~/.mifluz.


.SH AUTHORS
Loic Dachary loic@gnu.org

The Ht://Dig group http://dev.htdig.org/


.SH SEE ALSO
htdb_dump(1), htdb_stat(1), htdb_load(1), mifluzdump(1), mifluzload(1), mifluzdict(1), WordContext(3), WordList(3), WordDict(3), WordListOne(3), WordKey(3), WordKeyInfo(3), WordType(3), WordDBInfo(3), WordRecordInfo(3), WordRecord(3), WordReference(3), WordCursor(3), WordCursorOne(3), WordMonitor(3), Configuration(3), mifluz(3)

